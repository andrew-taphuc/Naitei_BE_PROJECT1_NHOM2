// DATABASE SCHEMA CHO WEBSITE BÁN CÂY CẢNH (OPTIMIZED)
// Mọi người copy vào script DBDiagram để xem nhé
Table users {
  id int [pk, increment]
  full_name varchar(255) [not null]
  email varchar(255) [unique, not null]
  phone varchar(20)
  address text
  password varchar(255) [not null]
  image varchar(255)
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [default: `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`]
}

Table categories {
  id int [pk, increment]
  name varchar(255) [not null]
  type enum('product', 'blog') [default: 'product']
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
}

Table products {
  id int [pk, increment]
  name varchar(255) [not null]
  category_id int [ref: > categories.id]
  old_price decimal(10,2) [not null]
  discount decimal(5,2) [default: 0]
  description text
  images json [note: 'Array of image URLs with is_primary flag']
  variants json [note: 'Array of variants: {name, price, in_stock, color, type}']
  specifications json [note: 'Object with spec_name: spec_value pairs']
  rating decimal(3,2) [default: 0]
  review_count int [default: 0]
  in_stock boolean [default: true]
  care_instructions text
  new_arrival boolean [default: false]
  tags varchar(500) [note: 'Comma-separated tag names']
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [default: `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`]
}

Table reviews {
  id varchar(50) [pk]
  product_id int [not null, ref: > products.id]
  user_id int [ref: > users.id]
  user_name varchar(255) [not null]
  rating int [not null, note: 'CHECK (rating >= 1 AND rating <= 5)']
  comment text
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
}

Table orders {
  id varchar(50) [pk]
  user_id int [not null, ref: > users.id]
  items json [note: 'Array of {product_id, product_name, price, quantity, discount, image_url}']
  total decimal(10,2) [not null]
  status varchar(20) [default: 'pending', note: 'pending, processing, shipped, delivered, cancelled']
  payment_method varchar(100)
  shipping_address text
  phone varchar(20)
  email varchar(255)
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [default: `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`]
}

Table wishlist {
  id int [pk, increment]
  user_id int [not null, ref: > users.id]
  product_id int [not null, ref: > products.id]
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
  
  indexes {
    (user_id, product_id) [unique]
  }
}

Table blogs {
  id int [pk, increment]
  title varchar(500) [not null]
  description text
  contents longtext
  category_id int [ref: > categories.id]
  images json [note: 'Array of image URLs']
  tags varchar(500) [note: 'Comma-separated tag names']
  author_id int [ref: > users.id]
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [default: `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`]
}

Table comments {
  id int [pk, increment]
  blog_id int [not null, ref: > blogs.id]
  user_id int [ref: > users.id]
  content text [not null]
  reply_to int [ref: > comments.id, note: 'Self-referencing for nested comments']
  created_at timestamp [default: `CURRENT_TIMESTAMP`]
}